{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '48306389-9c3f7e9b102fd2bc2270acf47';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport function fetchPhotosByQuery(query, currentPage) {\n  const axiosOptions = {\n    params: {\n      key: API_KEY,\n      page: currentPage,\n      per_page: 15,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  };\n\n  return axios.get(`${BASE_URL}`, axiosOptions);\n}\n","export function createGalleryCardTemplate(imgInfo) {\n  return imgInfo\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n  <article class=\"card\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\"\n      ><img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\"\n    /></a>\n    <ul class=\"info-list\">\n      <li class=\"info-item\">\n        <h2 class=\"info-subtitle\">Likes:</h2>\n        <p class=\"info-text\">${likes}</p>\n      </li>\n      <li class=\"info-item\">\n        <h2 class=\"info-subtitle\">Views:</h2>\n        <p class=\"info-text\">${views}</p>\n      </li>\n      <li class=\"info-item\">\n        <h2 class=\"info-subtitle\">Comments:</h2>\n        <p class=\"info-text\">${comments}</p>\n      </li>\n      <li class=\"info-item\">\n        <h2 class=\"info-subtitle\">Downloads:</h2>\n        <p class=\"info-text\">${downloads}</p>\n      </li>\n    </ul>\n  </article>\n</li>`;\n      }\n    )\n    .join('');\n}\n","// Завантажимо бібліотеки\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\n// Отримуємо посилання на елементи сторінки\nconst formSearchCard = document.querySelector('.form-search');\nconst listGalleryCard = document.querySelector('.gallery');\nconst loaderStyle = document.querySelector('.loader');\nconst buttonLoadEl = document.querySelector('.button-load');\n\nlet page = 1; //номер сторінки результатів пошуку. Починаємо з 1.\nlet query = ''; //зберігає ключове слово, яке ввів користувач у формі.\n\nloaderStyle.style.display = 'none'; //сховаємо лоадер\nbuttonLoadEl.classList.add('is-hidden'); //сховаємо кнопку Load More\n\n//Ініціалізація SimpleLightbox- створення модального вікна,\n//(зображення відкривається у великому розмірі).\nconst lightboxModalWindow = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionsPosition: 'bottom',\n  captionsDelay: 500,\n});\n\n//ф-ія викликається при сабміті форми\nconst searchImg = async event => {\n  try {\n    event.preventDefault(); // Запобігаємо перезавантаженню сторінки\n\n    query = event.target.query.value.trim(); //зчитуємо значення з інпута, видаляючи пробіли\n    //відмалювали картки в галереї\n    listGalleryCard.innerHTML = ''; //почистили галерею\n\n    //перевірка, чи інпут не порожній\n    if (!query) {\n      iziToast.error({\n        title: 'Error',\n        messageColor: 'Purple',\n        color: 'red',\n        position: 'topRight',\n        message: 'Please enter your request',\n        messageSize: '20',\n      });\n      return;\n    }\n\n    page = 1; // відкриємо 1 сторінку при кожному пошуку\n\n    buttonLoadEl.classList.add('is-hidden'); //сховаємо кнопку Load More\n\n    //Зробили запит по ключовому слову query\n    const { data } = await fetchPhotosByQuery(query, page);\n\n    //Якщо на сервері немає зображень за таким пошуком, відображається сповіщення про помилку.\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: '',\n        messageColor: 'Purple',\n        color: 'red',\n        position: 'topRight',\n        messageSize: '20',\n        message: 'Sorry, there are no images. Please try again!',\n      });\n      return;\n    }\n\n    //домалювали картки в кінець галереї\n    listGalleryCard.insertAdjacentHTML(\n      'beforeend',\n      createGalleryCardTemplate(data.hits)\n    );\n    // якщо карток більше 1 сторінки, покажемо кнопку Lode More\n    if (data.totalHits > page * 15) {\n      buttonLoadEl.classList.remove('is-hidden');\n    }\n    lightboxModalWindow.refresh(); //оновлюємо галерею SimpleLightbox\n    event.preventDefault();\n  } catch (error) {\n    console.error(error.message);\n  } finally {\n    loaderStyle.style.display = 'none'; //ховаємо лоадер\n  }\n  //очистимо форму після завершення запиту\n  event.target.reset();\n};\n\n// Додаємо обробник події на форму пошуку\nformSearchCard.addEventListener('submit', searchImg);\n\n// опишемо ф-ію обробника кліка\nconst onButtonLoadClick = async () => {\n  try {\n    page++;\n    const { data } = await fetchPhotosByQuery(query, page);\n\n    //додаємо нові зображення в кінець нашого списку\n    listGalleryCard.insertAdjacentHTML(\n      'beforeend',\n      createGalleryCardTemplate(data.hits)\n    );\n\n    //коли настає кінець колекції\n    if (page * 15 >= data.totalHits || data.hits.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        messageColor: 'teal',\n        color: 'blue',\n        position: 'topRight',\n        messageSize: '20',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n\n      buttonLoadEl.classList.add('is-hidden'); // ховаємо кнопку\n      return;\n    }\n    //реалізуєио плавний скрол на 2 карточки\n    const smoothScroll = document.querySelector('.gallery-item');\n    if (smoothScroll) {\n      const cardHeight = smoothScroll.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      position: 'topRight',\n      message: 'Please try again later.',\n    });\n  }\n};\n//слухаємо подію клік на кнопці\nbuttonLoadEl.addEventListener('click', onButtonLoadClick);\n"],"names":["API_KEY","BASE_URL","fetchPhotosByQuery","query","currentPage","axiosOptions","axios","createGalleryCardTemplate","imgInfo","webformatURL","largeImageURL","tags","likes","views","comments","downloads","formSearchCard","listGalleryCard","loaderStyle","buttonLoadEl","page","lightboxModalWindow","SimpleLightbox","searchImg","event","iziToast","data","error","onButtonLoadClick","smoothScroll","cardHeight"],"mappings":"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"}